<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<title>輸送障害JSON作成ツール</title>
<script src="https://cdn.tailwindcss.com"></script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet">
<style>
  body { font-family: 'Inter','Noto Sans JP',sans-serif; background-color:#f8fffe; }
  .header-card { background: linear-gradient(135deg, #064e3b 0%, #065f46 100%); }
  .system-card { background: #fff; border: 1px solid #d1fae5; box-shadow: 0 1px 3px rgba(6,78,59,0.1); }
  .filter-input { background: #fff; border: 1px solid #d1fae5; }
  .filter-input:focus { border-color: #34d399; box-shadow: 0 0 0 3px rgba(52,211,153,0.1); }
</style>
</head>
<body class="text-gray-800 p-6">

<header class="mb-6">
  <div class="header-card rounded-lg p-6 text-white shadow-sm flex gap-4 items-center">
    <span class="material-icons-outlined text-2xl">add_box</span>
    <div>
      <h1 class="text-2xl font-bold">輸送障害JSON作成ツール</h1>
      <p class="text-green-100 text-sm">Transport Incident Maker</p>
    </div>
  </div>
</header>
<!-- ...（ヘッダーの直後などに） -->
<div class="mb-6">
  <button onclick="location.href='top.html'" class="bg-green-100 hover:bg-green-200 border border-green-300 text-green-900 px-4 py-2 rounded flex items-center gap-1">
    <span class="material-icons-outlined text-base">home</span>
    メインページに戻る
  </button>
</div>
<!-- ...（従来のフォームなどに続く） -->

<div class="system-card rounded-lg p-6 mb-8">
  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
    <div>
      <label class="block text-sm font-medium text-gray-700 mb-1">表題</label>
      <input id="title" type="text" class="filter-input w-full px-3 py-2.5 rounded-md outline-none" placeholder="障害名">
    </div>
    <div>
      <label class="block text-sm font-medium text-gray-700 mb-1">発生日（YYYY-MM-DD HH:MM:SS）</label>
      <input id="datetime" type="text" class="filter-input w-full px-3 py-2.5 rounded-md outline-none" placeholder="例：2025-08-08 18:30:00">
    </div>
    <div>
      <label class="block text-sm font-medium text-gray-700 mb-1">場所</label>
      <input id="location" type="text" class="filter-input w-full px-3 py-2.5 rounded-md outline-none" placeholder="駅・線名など">
    </div>
    <div>
      <label class="block text-sm font-medium text-gray-700 mb-1">列番</label>
      <input id="trainNo" type="text" class="filter-input w-full px-3 py-2.5 rounded-md outline-none" placeholder="例：80レ">
    </div>
  </div>
  <div class="mt-6 mb-2">
    <label class="block text-sm font-medium text-gray-700 mb-1">障害概要</label>
    <textarea id="description" class="filter-input w-full px-3 py-2.5 rounded-md outline-none" placeholder="障害内容" rows="3"></textarea>
  </div>
  <div class="mb-2">
    <label class="block text-sm font-medium text-gray-700 mb-1">追記（1行ずつ）</label>
    <textarea id="notes" class="filter-input w-full px-3 py-2.5 rounded-md outline-none" placeholder="追記事項を行ごと" rows="2"></textarea>
  </div>

  <div class="mb-2">
    <label class="block text-sm font-medium text-gray-700 mb-2">タイムライン</label>
    <table id="timelineTable" class="w-full text-sm border">
      <thead class="bg-green-50">
        <tr>
          <th class="px-2 py-1 w-24">時刻</th>
          <th class="px-2 py-1">内容</th>
          <th class="px-2 py-1 w-16"></th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
    <button type="button" onclick="addTimelineRow()" class="bg-green-500 text-white mt-2 rounded px-4 py-2">
      ＋行追加
    </button>
  </div>
</div>

<div class="system-card rounded-lg p-6">
  <button onclick="generateJSON()" class="bg-green-600 text-white px-6 py-2 rounded font-bold mb-4">JSON生成</button>
  <div>
    <label class="block font-medium text-gray-700 mb-1">生成結果</label>
    <pre id="output" class="bg-gray-50 border rounded p-4 text-sm whitespace-pre-wrap"></pre>
  </div>
</div>

<script>
function addTimelineRow(){
  const table = document.getElementById('timelineTable').getElementsByTagName('tbody')[0];
  const row = document.createElement('tr');
  row.innerHTML = `
    <td class="px-2 py-1"><input class="filter-input w-full" placeholder="HH:MM"></td>
    <td class="px-2 py-1"><input class="filter-input w-full" placeholder="内容"></td>
    <td class="px-2 py-1 text-center"><button onclick="removeRow(this)" class="text-red-500">削除</button></td>
  `;
  table.appendChild(row);
}
function removeRow(btn){
  btn.parentElement.parentElement.remove();
}
function generateJSON(){
  const obj = {
    title: document.getElementById('title').value,
    datetime: document.getElementById('datetime').value,
    location: document.getElementById('location').value,
    trainNo: document.getElementById('trainNo').value,
    description: document.getElementById('description').value,
    notes: document.getElementById('notes').value.split('\n').filter(n => n.trim() !== ''),
    timeline: []
  };
  const rows = document.getElementById('timelineTable').getElementsByTagName('tbody')[0].rows;
  for(let i=0; i<rows.length; i++) {
    const t = rows[i].cells[0].querySelector('input').value;
    const txt = rows[i].cells[1].querySelector('input').value;
    if(t.trim() && txt.trim()) obj.timeline.push({ time: t, text: txt });
  }
  document.getElementById('output').textContent = JSON.stringify(obj, null, 2);
}
addTimelineRow();
</script>
</body>
</html>
