<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>KnowL Data Generator</title>
  <style>
    body { font-family: sans-serif; max-width: 800px; margin: 40px auto; }
    input, textarea, select { width: 100%; margin: 6px 0; padding: 6px; }
    button { margin-top: 10px; padding: 10px 20px; cursor: pointer; }
    pre { background: #f5f5f5; padding: 10px; border-radius: 8px; }
  </style>
</head>
<body>
  <h1>KnowL è¨˜äº‹ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆãƒ„ãƒ¼ãƒ«</h1>

  <label>è¨˜äº‹IDï¼š</label>
  <input id="id" placeholder="ä¾‹ï¼šarticle4">

  <label>ã‚¿ã‚¤ãƒˆãƒ«ï¼š</label>
  <input id="title" placeholder="ä¾‹ï¼šJSONç”Ÿæˆãƒ„ãƒ¼ãƒ«ã®ä½¿ã„æ–¹">

  <label>ã‚«ãƒ†ã‚´ãƒªï¼š</label>
  <input id="category" placeholder="ä¾‹ï¼šã‚·ã‚¹ãƒ†ãƒ ç®¡ç†">

  <label>ã‚¿ã‚°ï¼ˆã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šï¼‰ï¼š</label>
  <input id="tags" placeholder="ä¾‹ï¼šãƒ„ãƒ¼ãƒ«, JSON, è‡ªå‹•åŒ–">

  <label>æœ¬æ–‡ï¼š</label>
  <textarea id="content" rows="6" placeholder="HTMLå¯ã€‚èª¬æ˜æ–‡ã‚’å…¥åŠ›"></textarea>

  <label>é–¢é€£è¨˜äº‹IDï¼ˆã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šï¼‰ï¼š</label>
  <input id="related" placeholder="ä¾‹ï¼šarticle1, article3">

  <label>å‚ç…§ãƒªãƒ³ã‚¯ï¼ˆå½¢å¼ï¼šè¡¨ç¤ºå:id, è¡¨ç¤ºå:idï¼‰ï¼š</label>
  <input id="reference" placeholder="ä¾‹ï¼šè¨­å®šã‚¬ã‚¤ãƒ‰:article1, PWAå°å…¥:article3">

  <button onclick="generate()">JSONç”Ÿæˆ</button>

  <h2>ç”Ÿæˆçµæœï¼š</h2>
  <pre id="output"></pre>
  <button id="copyBtn" style="display:none;">ğŸ“‹ ã‚³ãƒ”ãƒ¼</button>

  <script>
    function generate() {
      const id = document.getElementById("id").value.trim();
      const title = document.getElementById("title").value.trim();
      const category = document.getElementById("category").value.trim();
      const tags = document.getElementById("tags").value.split(",").map(t => t.trim()).filter(t => t);
      const content = document.getElementById("content").value.trim();
      const related = document.getElementById("related").value.split(",").map(r => r.trim()).filter(r => r);
      const referenceInput = document.getElementById("reference").value.trim();

      // reference: "è¡¨ç¤ºå:id" ã®å½¢å¼ã‚’ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›
      const reference = {};
      if (referenceInput) {
        referenceInput.split(",").forEach(pair => {
          const [key, value] = pair.split(":").map(s => s.trim());
          if (key && value) reference[key] = value;
        });
      }

      // ISOå½¢å¼ã®ç¾åœ¨æ™‚åˆ»
      const updated_at = new Date().toISOString();

      const article = {
        id, title, category, tags, content,
        related: related.length ? related : undefined,
        reference: Object.keys(reference).length ? reference : undefined,
        updated_at
      };

      const jsonText = JSON.stringify(article, null, 2);
      document.getElementById("output").textContent = jsonText;

      const copyBtn = document.getElementById("copyBtn");
      copyBtn.style.display = "inline-block";
      copyBtn.onclick = () => {
        navigator.clipboard.writeText(jsonText);
        copyBtn.textContent = "âœ… ã‚³ãƒ”ãƒ¼æ¸ˆã¿ï¼";
        setTimeout(() => copyBtn.textContent = "ğŸ“‹ ã‚³ãƒ”ãƒ¼", 2000);
      };
    }
  </script>
</body>
</html>
