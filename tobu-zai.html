
<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width,initial-scale=0.5" />
    <link rel="stylesheet" href="/tid.css">
	<title>東武線在線モニタ</title>
    <script type="text/javascript">
        const linedata =
            {
                "TobuSkytree":
                {
                    uri: "odpt.Railway:Tobu.TobuSkytree",
                    line_id: "TS",
                    line_name: "本線系統",
                    sections:
                    [
                        {
                            stop_id: "Asakusa",
                            stop_name: "浅草",
                            tracks: "M-3,-1H6 M-3,1H6",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["TokyoSkytree_Asakusa", "Asakusa_TokyoSkytree"]
                        },
                        {
                            stop_id: "TokyoSkytree",
                            stop_name: "ｽｶｲﾂﾘｰ",
                            tracks: "M-6,-1H6 M-6,1H6",
                            plats: [0,1]
                        },
                        {
                            section_id: ["Hikifune_TokyoSkytree", "TokyoSkytree_Hikifune"]
                        },
                        {
                            stop_id: "Hikifune",
                            stop_name: "曳舟",
                            tracks: "M-6,-1H-4L-3,-3H3.5L4.5,-1H6 M-6,1H-4L-3,3H3.5L4.5,1H6 M-2.5,-1H2L3,-3 M-2.5,1H2L3,3 M5,-1L6,1 M5,1L6,-1",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["HigashiMukojima_Hikifune", "Hikifune_HigashiMukojima"]
                        },
                        {
                            stop_id: "HigashiMukojima",
                            stop_name: "東向島",
                            tracks: "M-6,-1H6 M-6,1H6",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["Kanegafuchi_HigashiMukojima", "HigashiMukojima_Kanegafuchi"]
                        },
                        {
                            stop_id: "Kanegafuchi",
                            stop_name: "鐘ヶ淵",
                            tracks: "M-6,-1H-5L-4,-3H3L4,-1 M-3,-3L-2,-1H6 M-6,1H3L4,3 M-3,1L-2,3H5L6,1",
                            plats: [-2,2]
                        },
                        {
                            section_id: ["Horikiri_Kanegafuchi", "Kanegafuchi_Horikiri"]
                        },
                        {
                            stop_id: "Horikiri",
                            stop_name: "堀切",
                            tracks: "M-6,-1H6 M-6,1H6",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["Ushida_Horikiri", "Horikiri_Ushida"]
                        },
                        {
                            stop_id: "Ushida",
                            stop_name: "牛田",
                            tracks: "M-6,-1H6 M-6,1H6",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["KitaSenju_Ushida", "Ushida_KitaSenju"]
                        },
                        {
                            stop_id: "KitaSenju",
                            stop_name: "北千住",
                            tracks: "M-6,-1H3L3.5,-3H6 M-6,1L-5,5H3.5L4,3H6 M-3,-1L-2,1H3L3.5,-1H6 M-5.5,3H3.5L4,1H6 M-3,-5H5L5.5,-0.25H5.75L6,-1 M-3,-3H3L3.5,0.25H5.5L6,1 M4,-3L5,-1M4,-1L5,-3 M4.5,1L5.5,3M4.5,3L5.5,1",
                            plats: [-2,0,2]
                        },
                        {
                            section_id: ["Kosuge_KitaSenju", "L_Kosuge_KitaSenju", "L_KitaSenju_Kosuge" , "KitaSenju_Kosuge"]
                        },
                        {
                            stop_id: "Kosuge",
                            stop_name: "小菅",
                            tracks: "M-6,-1H6 M-6,1H6 M-6,-3H6 M-6,3H6",
                            plats: [0]
                        },
                        {
                            section_id: ["Gotanno_Kosuge", "L_Gotanno_Kosuge", "L_Kosuge_Gotanno", "Kosuge_Gotanno"]
                        },
                        {
                            stop_id: "Gotanno",
                            stop_name: "五反野",
                            tracks: "M-6,-1H6 M-6,1H6 M-6,-3H6 M-6,3H6",
                            plats: [0]
                        },
                        {
                            section_id: ["Umejima_Gotanno", "L_Umejima_Gotanno", "L_Gotanno_Umejima", "Gotanno_Umejima"]
                        },
                        {
                            stop_id: "Umejima",
                            stop_name: "梅島",
                            tracks: "M-6,-1H6 M-6,1H6 M-6,-3H6 M-6,3H6",
                            plats: [0]
                        },
                        {
                            section_id: ["Nishiarai_Umejima", "L_Nishiarai_Umejima", "L_Umejima_Nishiarai", "Umejima_Nishiarai"]
                        },
                        {
                            stop_id: "Nishiarai",
                            stop_name: "西新井",
                            tracks: "M-6,-1H6 M-6,1H6 M-6,-3H6 M-6,3H6 M-5,-1L-4,-3 M-5,1L-4,3",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["Takenotsuka_Nishiarai", "L_Takenotsuka_Nishiarai", "L_Nishiarai_Takenotsuka", "Nishiarai_Takenotsuka"]
                        },
                        {
                            stop_id: "Takenotsuka",
                            stop_name: "竹ノ塚",
                            tracks: "M-6,-1H6 M-6,1H6 M-6,-3H6 M-6,3H6",
                            plats: [0]
                        },
                        {
                            section_id: ["Yatsuka_Takenotsuka", "L_Yatsuka_Takenotsuka", "L_Takenotsuka_Yatsuka", "Takenotsuka_Yatsuka"]
                        },
                        {
                            stop_id: "Yatsuka",
                            stop_name: "谷塚",
                            tracks: "M-6,-1H6 M-6,1H6 M-6,-3H6 M-6,3H6",
                            plats: [0]
                        },
                        {
                            section_id: ["Soka_Yatsuka", "L_Soka_Yatsuka", "L_Yatsuka_Soka", "Yatsuka_Soka"]
                        },
                        {
                            stop_id: "Soka",
                            stop_name: "草加",
                            tracks: "M-6,-1H6 M-6,1H6 M-6,-3H-5L-4,-5H4L5,-3H6 M-6,3H-5L-4,5H4L5,3H6 M-3,-5L-2,-3H2L3,-5 M-3,5L-2,3H2L3,5",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["Dokkyodaigakumae_Soka", "L_Dokkyodaigakumae_Soka", "L_Soka_Dokkyodaigakumae", "Soka_Dokkyodaigakumae"]
                        },
                        {
                            stop_id: "Dokkyodaigakumae",
                            stop_name: "獨協大学",
                            tracks: "M-6,-1H6 M-6,1H6 M-6,-3H6 M-6,3H6",
                            plats: [0]
                        },
                        {
                            section_id: ["Shinden_Dokkyodaigakumae", "L_Shinden_Dokkyodaigakumae", "L_Dokkyodaigakumae_Shinden", "Dokkyodaigakumae_Shinden"]
                        },
                        {
                            stop_id: "Shinden",
                            stop_name: "新田",
                            tracks: "M-6,-1H6 M-6,1H6 M-6,-3H6 M-6,3H6",
                            plats: [0]
                        },
                        {
                            section_id: ["Gamo_Shinden", "L_Gamo_Shinden", "L_Shinden_Gamo", "Shinden_Gamo"]
                        },
                        {
                            stop_id: "Gamo",
                            stop_name: "蒲生",
                            tracks: "M-6,-1H6 M-6,1H6 M-6,-3H6 M-6,3H6",
                            plats: [0]
                        },
                        {
                            section_id: ["ShinKoshigaya_Gamo", "L_ShinKoshigaya_Gamo", "L_Gamo_ShinKoshigaya", "Gamo_ShinKoshigaya"]
                        },
                        {
                            stop_id: "ShinKoshigaya",
                            stop_name: "新越谷",
                            tracks: "M-6,-1H6 M-6,1H6 M-6,-3H6 M-6,3H6",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["Koshigaya_ShinKoshigaya", "L_Koshigaya_ShinKoshigaya", "L_ShinKoshigaya_Koshigaya", "ShinKoshigaya_Koshigaya"]
                        },
                        {
                            stop_id: "Koshigaya",
                            stop_name: "越谷",
                            tracks: "M-6,-1H6 M-6,1H6 M-6,-3H-5L-4,-5H4L5,-3H6 M-6,3H-5L-4,5H4L5,3H6 M-3,-5L-2,-3H2L3,-5 M-3,5L-2,3H2L3,5",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["KitaKoshigaya_Koshigaya", "L_KitaKoshigaya_Koshigaya", "L_Koshigaya_KitaKoshigaya", "Koshigaya_KitaKoshigaya"]
                        },
                        {
                            stop_id: "KitaKoshigaya",
                            stop_name: "北越谷",
                            tracks: "M-6,-1H5 M-6,1H5 M-6,-3H5L6,-1 M-6,3H5L6,1 M-3,3L-2,1M-3,-3L-2,-1 M2,3L3,1M2,-3L3,-1 M2.5,-1L3,-2H3.5L4,-3 M2.5,1L3,2H3.5L4,3",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["Obukuro_KitaKoshigaya", "KitaKoshigaya_Obukuro"]
                        },
                        {
                            stop_id: "Obukuro",
                            stop_name: "大袋",
                            tracks: "M-6,-1H6 M-6,1H6",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["Sengendai_Obukuro", "Obukuro_Sengendai"]
                        },
                        {
                            stop_id: "Sengendai",
                            stop_name: "せんげん",
                            tracks: "M-6,-1H6 M-6,1H6 M-3,-1L-2,-3H2L3,-1 M-3,1L-2,3H2L3,1",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["Takesato_Sengendai", "Sengendai_Takesato"]
                        },
                        {
                            stop_id: "Takesato",
                            stop_name: "武里",
                            tracks: "M-6,-1H6 M-6,1H6",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["Ichinowari_Takesato", "Takesato_Ichinowari"]
                        },
                        {
                            stop_id: "Ichinowari",
                            stop_name: "一ノ割",
                            tracks: "M-6,-1H6 M-6,1H6",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["Kasukabe_Ichinowari", "Ichinowari_Kasukabe"]
                        },
                        {
                            stop_id: "Kasukabe",
                            stop_name: "春日部",
                            tracks: "M-6,-1H6 M-6,1H6",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["KitaKasukabe_Kasukabe", "Kasukabe_KitaKasukabe"]
                        },
                        {
                            stop_id: "KitaKasukabe",
                            stop_name: "北春日部",
                            tracks: "M-6,-1H6 M-6,1H6",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["Himemiya_KitaKasukabe", "KitaKasukabe_Himemiya"]
                        },
                        {
                            stop_id: "Himemiya",
                            stop_name: "姫宮",
                            tracks: "M-6,-1H6 M-6,1H6",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["TobuDobutsuKoen_Himemiya", "Himemiya_TobuDobutsuKoen"]
                        },
                        {
                            stop_id: "TobuDobutsuKoen",
                            stop_name: "東武動物",
                            tracks: "M-6,-1H6 M-6,1H6",
                            plats: [-1,1]
                        },

                    ]
                },
                "Isesaki":
                {
                    uri: "odpt.Railway:Tobu.Isesaki",
                    line_id: "TI",
                    line_name: "伊勢崎",
                    sections:
                    [
                        {
                            stop_id: "Asakusa",
                            stop_name: "浅草",
                            tracks: "M-6,-1H6 M-6,1H6",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["", ""]
                        },
                    ]
                },
                "Nikko":
                {
                    uri: "odpt.Railway:Tobu.Nikko",
                    line_id: "TN",
                    line_name: "日光",
                    sections:
                    [
                        {
                            stop_id: "Asakusa",
                            stop_name: "浅草",
                            tracks: "M-6,-1H6 M-6,1H6",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["", ""]
                        },
                    ]
                },
                "TobuUrbanPark":
                {
                    uri: "odpt.Railway:Tobu.TobuUrbanPark",
                    line_id: "TD",
                    line_name: "野田",
                    sections:
                    [
                        {
                            stop_id: "Omiya",
                            stop_name: "大宮",
                            tracks: "M-3,-1H6 M-3,1H6 M4,-1L5,1 M4,1L5,-1",
                            plats: [0]
                        },
                        {
                            section_id: ["KitaOmiya_Omiya", "Omiya_KitaOmiya"]
                        },
                        {
                            stop_id: "KitaOmiya",
                            stop_name: "北大宮",
                            tracks: "M-6,-1H6 M-6,1H6",
                            plats: [0]
                        },
                        {
                            section_id: ["OmiyaKoen_KitaOmiya", "KitaOmiya_OmiyaKoen"]
                        },
                        {
                            stop_id: "OmiyaKoen",
                            stop_name: "大宮公園",
                            tracks: "M-6,-1H6 M-6,1H6",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["Owada_OmiyaKoen", "OmiyaKoen_Owada"]
                        },
                        {
                            stop_id: "Owada",
                            stop_name: "大和田",
                            tracks: "M-6,-1H6 M-6,1H6",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["Nanasato_Owada", "Owada_Nanasato"]
                        },
                        {
                            stop_id: "Nanasato",
                            stop_name: "七里",
                            tracks: "M-6,-1H6 M-6,1H6",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["Iwatsuki_Nanasato", "Nanasato_Iwatsuki"]
                        },
                        {
                            stop_id: "Iwatsuki",
                            stop_name: "岩槻",
                            tracks: "M-6,-1H6 M-6,1H6",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["HigashiIwatsuki_Iwatsuki", "Iwatsuki_HigashiIwatsuki"]
                        },
                        {
                            stop_id: "HigashiIwatsuki",
                            stop_name: "東岩槻",
                            tracks: "M-6,-1H6 M-6,1H6",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["Toyoharu_HigashiIwatsuki", "HigashiIwatsuki_Toyoharu"]
                        },
                        {
                            stop_id: "Toyoharu",
                            stop_name: "豊春",
                            tracks: "M-6,-1H6 M-6,1H6",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["Yagisaki_Toyoharu", "Toyoharu_Yagisaki"]
                        },
                        {
                            stop_id: "Yagisaki",
                            stop_name: "八木崎",
                            tracks: "M-6,-1H6 M-6,1H6",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["Kasukabe_Yagisaki", "Yagisaki_Kasukabe"]
                        },
                        {
                            stop_id: "Kasukabe",
                            stop_name: "春日部",
                            tracks: "M-6,-1H6 M-6,1H6",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["FujinoUshijima_Kasukabe", "Kasukabe_FujinoUshijima"]
                        },
                        {
                            stop_id: "FujinoUshijima",
                            stop_name: "藤の牛島",
                            tracks: "M-6,-1H6 M-6,1H6",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["MinamiSakurai_FujinoUshijima", "FujinoUshijima_MinamiSakurai"]
                        },
                        {
                            stop_id: "MinamiSakurai",
                            stop_name: "南桜井",
                            tracks: "M-6,-1H6 M-6,1H6",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["Kawama_MinamiSakurai", "MinamiSakurai_Kawama"]
                        },
                        {
                            stop_id: "Kawama",
                            stop_name: "川間",
                            tracks: "M-6,-1H6 M-6,1H6",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["Nanakodai_Kawama", "Kawama_Nanakodai"]
                        },
                        {
                            stop_id: "Nanakodai",
                            stop_name: "七光台",
                            tracks: "M-6,-1H6 M-6,1H6",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["ShimizuKoen_Nanakodai", "Nanakodai_ShimizuKoen"]
                        },
                        {
                            stop_id: "ShimizuKoen",
                            stop_name: "清水公園",
                            tracks: "M-6,-1H6 M-6,1H6",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["Atago_ShimizuKoen", "ShimizuKoen_Atago"]
                        },

                        {
                            stop_id: "Atago",
                            stop_name: "愛宕",
                            tracks: "M-6,-1H6 M-6,1H6",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["Nodashi_Atago", "Atago_Nodashi"]
                        },
                        {
                            stop_id: "Nodashi",
                            stop_name: "野田市",
                            tracks: "M-6,-1H6 M-6,1H6",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["Umesato_Nodashi", "Nodashi_Umesato"]
                        },
                        {
                            stop_id: "Umesato",
                            stop_name: "梅郷",
                            tracks: "M-6,-1H6 M-6,1H6",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["Unga_Umesato", "Umesato_Unga"]
                        },
                        {
                            stop_id: "Unga",
                            stop_name: "運河",
                            tracks: "M-6,-1H6 M-6,1H6",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["Edogawadai_Unga", "Unga_Edogawadai"]
                        },
                        {
                            stop_id: "Edogawadai",
                            stop_name: "江戸川台",
                            tracks: "M-6,-1H6 M-6,1H6",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["Hatsuishi_Edogawadai", "Edogawadai_Hatsuishi"]
                        },
                        {
                            stop_id: "Hatsuishi",
                            stop_name: "初石",
                            tracks: "M-6,-1H6 M-6,1H6",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["NagareyamaOtakanomori_Hatsuishi", "Hatsuishi_NagareyamaOtakanomori"]
                        },
                        {
                            stop_id: "NagareyamaOtakanomori",
                            stop_name: "おおたか",
                            tracks: "M-6,-1H6 M-6,1H6",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["Toyoshiki_NagareyamaOtakanomori", "NagareyamaOtakanomori_Toyoshiki"]
                        },
                        {
                            stop_id: "Toyoshiki",
                            stop_name: "豊四季",
                            tracks: "M-6,-1H6 M-6,1H6",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["Kashiwa_Toyoshiki", "Toyoshiki_Kashiwa"]
                        },
                        {
                            stop_id: "Kashiwa",
                            stop_name: "柏",
                            tracks: "M-6,-1H6 M-6,1H6",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["ShinKashiwa_Kashiwa", "Kashiwa_ShinKashiwa"]
                        },
                        {
                            stop_id: "ShinKashiwa",
                            stop_name: "新柏",
                            tracks: "M-6,-1H6 M-6,1H6",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["Masuo_ShinKashiwa", "ShinKashiwa_Masuo"]
                        },
                        {
                            stop_id: "Masuo",
                            stop_name: "増尾",
                            tracks: "M-6,-1H6 M-6,1H6",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["Sakasai_Masuo", "Masuo_Sakasai"]
                        },
                        {
                            stop_id: "Sakasai",
                            stop_name: "逆井",
                            tracks: "M-6,-1H6 M-6,1H6",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["Takayanagi_Sakasai", "Sakasai_Takayanagi"]
                        },
                        {
                            stop_id: "Takayanagi",
                            stop_name: "高柳",
                            tracks: "M-6,-1H6 M-6,1H6",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["Mutsumi_Takayanagi", "Takayanagi_Mutsumi"]
                        },
                        {
                            stop_id: "Mutsumi",
                            stop_name: "六実",
                            tracks: "M-6,-1H6 M-6,1H6",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["ShinKamagaya_Mutsumi", "Mutsumi_ShinKamagaya"]
                        },
                        {
                            stop_id: "ShinKamagaya",
                            stop_name: "新鎌ヶ谷",
                            tracks: "M-6,-1H6 M-6,1H6",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["Kamagaya_ShinKamagaya", "ShinKamagaya_Kamagaya"]
                        },
                        {
                            stop_id: "Kamagaya",
                            stop_name: "鎌ケ谷",
                            tracks: "M-6,-1H6 M-6,1H6",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["Magomezawa_Kamagaya", "Kamagaya_Magomezawa"]
                        },
                        {
                            stop_id: "Magomezawa",
                            stop_name: "馬込沢",
                            tracks: "M-6,-1H6 M-6,1H6",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["Tsukada_Magomezawa", "Magomezawa_Tsukada"]
                        },
                        {
                            stop_id: "Tsukada",
                            stop_name: "塚田",
                            tracks: "M-6,-1H6 M-6,1H6",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["ShinFunabashi_Tsukada", "Tsukada_ShinFunabashi"]
                        },
                        {
                            stop_id: "ShinFunabashi",
                            stop_name: "新船橋",
                            tracks: "M-6,-1H6 M-6,1H6",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["Funabashi_ShinFunabashi", "ShinFunabashi_Funabashi"]
                        },
                        {
                            stop_id: "Funabashi",
                            stop_name: "船橋",
                            tracks: "M-6,-1H3 M-6,1H3",
                            plats: [-1,1]
                        },

                    ]
                },
                "Tojo":
                {
                    uri: "odpt.Railway:Tobu.Tojo",
                    line_id: "TJ",
                    line_name: "東上",
                    sections:
                    [
                        {
                            stop_id: "Ikebukuro",
                            stop_name: "池袋",
                            tracks: "M-6,-1H6 M-6,1H6",
                            plats: [-1,1]
                        },
                        {
                            section_id: ["", ""]
                        },
                    ]
                }
            }

        const sta_list =
            {
                //本線系統
                "odpt.Station:Tobu.TobuSkytree.Asakusa":["浅草","浅"],
                "odpt.Station:Tobu.TobuSkytree.TokyoSkytree":["東京スカイツリー","ｽｶｲ"],
                "odpt.Station:Tobu.TobuSkytree.Hikifune":["曳舟","曳"],
                "odpt.Station:Tobu.TobuSkytree.HigashiMukojima":["東向島","向島"],
                "odpt.Station:Tobu.TobuSkytree.Kanegafuchi":["鐘ヶ淵","鐘"],
                "odpt.Station:Tobu.TobuSkytree.Horikiri":["堀切","堀切"],
                "odpt.Station:Tobu.TobuSkytree.Ushida":["牛田","牛"],
                "odpt.Station:Tobu.TobuSkytree.KitaSenju":["北千住","千住"],
                "odpt.Station:Tobu.TobuSkytree.Kosuge":["小菅","小菅"],
                "odpt.Station:Tobu.TobuSkytree.Gotanno":["五反野","五反"],
                "odpt.Station:Tobu.TobuSkytree.Umejima":["梅島","梅"],
                "odpt.Station:Tobu.TobuSkytree.Nishiarai":["西新井","新井"],
                "odpt.Station:Tobu.TobuSkytree.Takenotsuka":["竹ノ塚","竹"],
                "odpt.Station:Tobu.TobuSkytree.Yatsuka":["谷塚","谷塚"],
                "odpt.Station:Tobu.TobuSkytree.Soka":["草加","草"],
                "odpt.Station:Tobu.TobuSkytree.Dokkyodaigakumae":["獨協大学前","獨協"],
                "odpt.Station:Tobu.TobuSkytree.Shinden":["新田","新田"],
                "odpt.Station:Tobu.TobuSkytree.Gamo":["蒲生","蒲生"],
                "odpt.Station:Tobu.TobuSkytree.ShinKoshigaya":["新越谷","新越"],
                "odpt.Station:Tobu.TobuSkytree.Koshigaya":["越谷","越谷"],
                "odpt.Station:Tobu.TobuSkytree.KitaKoshigaya":["北越谷","北越"],
                "odpt.Station:Tobu.TobuSkytree.Obukuro":["大袋","大袋"],
                "odpt.Station:Tobu.TobuSkytree.Sengendai":["せんげん台","せ"],
                "odpt.Station:Tobu.TobuSkytree.Takesato":["武里","武里"],
                "odpt.Station:Tobu.TobuSkytree.Ichinowari":["一ノ割","一"],
                "odpt.Station:Tobu.TobuSkytree.Kasukabe":["春日部","春"],
                "odpt.Station:Tobu.TobuSkytree.KitaKasukabe":["北春日部","ｷｶｽ"],
                "odpt.Station:Tobu.TobuSkytree.Himemiya":["姫宮","姫"],
                "odpt.Station:Tobu.TobuSkytree.TobuDobutsuKoen":["東武動物公園","ﾄﾌﾞ"],

                //伊勢崎
                "odpt.Station:Tobu.Isesaki.Kuki":["久喜","ｸｷ"],
                "odpt.Station:Tobu.Isesaki.Tatebayashi":["館林","館林"],

                //桐生、佐野
                "odpt.Station:Tobu.Sano.Kuzu":["葛生","葛"],
                "odpt.Station:Tobu.Kiryu.Akagi":["赤城","赤城"],

                //日光
                "odpt.Station:Tobu.Nikko.MinamiKurihashi":["南栗橋","ﾐｸﾘ"],
                "odpt.Station:Tobu.Nikko.TobuNikko":["東武日光","ﾄﾆｺ"],

                //野田
                "odpt.Station:Tobu.TobuUrbanPark.Omiya":["大宮","宮"],
                "odpt.Station:Tobu.TobuUrbanPark.KitaOmiya":["北大宮","北大"],
                "odpt.Station:Tobu.TobuUrbanPark.OmiyaKoen":["大宮公園","宮公"],
                "odpt.Station:Tobu.TobuUrbanPark.Owada":["大和田","大和"],
                "odpt.Station:Tobu.TobuUrbanPark.Nanasato":["七里","七里"],
                "odpt.Station:Tobu.TobuUrbanPark.Iwatsuki":["岩槻","槻"],
                "odpt.Station:Tobu.TobuUrbanPark.HigashiIwatsuki":["東岩槻","東岩"],
                "odpt.Station:Tobu.TobuUrbanPark.Toyoharu":["豊春","豊春"],
                "odpt.Station:Tobu.TobuUrbanPark.Yagisaki":["八木崎","八"],
                "odpt.Station:Tobu.TobuUrbanPark.Kasukabe":["春日部","春"],
                "odpt.Station:Tobu.TobuUrbanPark.FujinoUshijima":["藤の牛島","牛島"],
                "odpt.Station:Tobu.TobuUrbanPark.MinamiSakurai":["南桜井","桜井"],
                "odpt.Station:Tobu.TobuUrbanPark.Kawama":["川間","川間"],
                "odpt.Station:Tobu.TobuUrbanPark.Nanakodai":["七光台","七"],
                "odpt.Station:Tobu.TobuUrbanPark.ShimizuKoen":["清水公園","清水"],
                "odpt.Station:Tobu.TobuUrbanPark.Atago":["愛宕","愛宕"],
                "odpt.Station:Tobu.TobuUrbanPark.Nodashi":["野田市","野田"],
                "odpt.Station:Tobu.TobuUrbanPark.Umesato":["梅郷","梅"],
                "odpt.Station:Tobu.TobuUrbanPark.Unga":["運河","運河"],
                "odpt.Station:Tobu.TobuUrbanPark.Edogawadai":["江戸川台","江戸"],
                "odpt.Station:Tobu.TobuUrbanPark.Hatsuishi":["初石","初石"],
                "odpt.Station:Tobu.TobuUrbanPark.NagareyamaOtakanomori":["流山おおたかの森","流山"],
                "odpt.Station:Tobu.TobuUrbanPark.Toyoshiki":["豊四季","四季"],
                "odpt.Station:Tobu.TobuUrbanPark.Kashiwa":["柏","柏"],
                "odpt.Station:Tobu.TobuUrbanPark.ShinKashiwa":["新柏","新柏"],
                "odpt.Station:Tobu.TobuUrbanPark.Masuo":["増尾","増尾"],
                "odpt.Station:Tobu.TobuUrbanPark.Sakasai":["逆井","逆井"],
                "odpt.Station:Tobu.TobuUrbanPark.Takayanagi":["高柳","柳"],
                "odpt.Station:Tobu.TobuUrbanPark.Mutsumi":["六実","六実"],
                "odpt.Station:Tobu.TobuUrbanPark.ShinKamagaya":["新鎌ヶ谷","新鎌"],
                "odpt.Station:Tobu.TobuUrbanPark.Kamagaya":["鎌ケ谷","鎌ケ谷"],
                "odpt.Station:Tobu.TobuUrbanPark.Magomezawa":["馬込沢","馬込"],
                "odpt.Station:Tobu.TobuUrbanPark.Tsukada":["塚田","塚田"],
                "odpt.Station:Tobu.TobuUrbanPark.ShinFunabashi":["新船橋","新船"],
                "odpt.Station:Tobu.TobuUrbanPark.Funabashi":["船橋","船"],

                //東上

                //田都、半蔵門
                "odpt.Station:Tobu.TobuSkytreeBranch.Oshiage":["押上","押上"],
                "odpt.Station:Tokyu.DenEnToshi.Nagatsuta":["長津田","長津"],
                "odpt.Station:Tokyu.DenEnToshi.ChuoRinkan":["中央林間","林間"],

                //日比谷
                "odpt.Station:TokyoMetro.Hibiya.NakaMeguro":["中目黒","中目"],
            }

        const sy_list = 
            {
                "odpt.TrainType:Tobu.Local":[1,"普通",""],
                "odpt.TrainType:Tobu.LimitedExpress":[2,"特急","特"],
                "odpt.TrainType:Tobu.Express":[3,"急行","急"],
                "odpt.TrainType:Tobu.SectionExpress":[4,"区間急行","区急"],
                "odpt.TrainType:Tobu.SemiExpress":[5,"準急","準"],
                "odpt.TrainType:Tobu.SectionSemiExpress":[6,"区間準急","区準"],
                "odpt.TrainType:Tobu.TH-LINER":[10,"THライナー","TH"],
                "odpt.TrainType:Tobu.TJ-Liner":[11,"TJライナー","TJ"],
                "odpt.TrainType:Tobu.KawagoeLimitedExpress":[12,"川越特急","川特"],
            }

        const sr_list =
            {
                1:["①"],
                2:["②"],
                3:["③"],
                4:["④"],
                5:["⑤"],
                6:["⑥"],
                7:["⑦"],
                8:["⑧"],
                9:["⑨"],
                10:["⑩"],
                11:["⑪"],
                12:["⑫"],
                13:["⑬"],
                14:["⑭"],
                15:["⑮"]
            }

        const token = "wvzxbmrc468he3y0p93ufz8ovhcqn5sauiiuixepg22wluhptpc42o78xfe38onh";

        function createSVG(tag)
            {
                return document.createElementNS("http://www.w3.org/2000/svg", tag);
            }
        
        var curline;
        function init()
        {
            curline = location.search;
            if (curline.length > 0)
                curline = curline.substring(1);

            var sel = document.getElementById("sel");
            Object.keys(linedata).forEach(function (o, i, a)
            {
                var btn = document.createElement("button");
                btn.className = "linetb" + linedata[o].line_id;
                btn.addEventListener("click", function () { trans(o); });
                btn.innerHTML = linedata[o].line_name;
                if (o == curline)
                    btn.disabled = true;
                sel.appendChild(btn);
            });

            if (!curline in linedata)
                return;

            var main = document.getElementById("main");
            linedata[curline].sections.forEach(function (o, i, a)
            {
                var sec = document.createElement("div");
                sec.style.height = "192px";
                sec.style.cssFloat = "left";
                sec.style.position = "relative";
                var svg = createSVG("svg");
                svg.setAttribute("height", "192px");
                if ('stop_id' in o)
                {
                    sec.style.width = "192px";
                    svg.setAttribute("width", "192px");
                    svg.setAttribute("viewBox", "-96 -96 192 192");

                    var text = createSVG("text");
                    text.setAttribute("x", 0);
                    text.setAttribute("y", 6);
                    text.setAttribute("font-size", 14);
                    text.setAttribute("font-weight", "bold");
                    text.setAttribute("color", "black");
                    text.setAttribute("text-anchor", "middle");
                    text.innerHTML = o.stop_name;
                    svg.appendChild(text);

                    if ("tracks" in o)
                    {
                        var track = createSVG("path");
                        track.setAttribute("d", o.tracks);
                        track.setAttribute("stroke", "black");
                        track.setAttribute("stroke-width", 0.125);
                        track.setAttribute("fill", "none");
                        track.setAttribute("transform", "scale(16)");
                        svg.appendChild(track);
                    }

                    if ("plats" in o)
                    {
                        o.plats.forEach(function (p, i, a)
                        {
                            var plat = createSVG("rect");
                            plat.setAttribute("x", -31.5);
                            plat.setAttribute("y", p * 32 - 9.5);
                            plat.setAttribute("width", 63);
                            plat.setAttribute("height", 19);
                            plat.setAttribute("stroke", "black");
                            plat.setAttribute("stroke-width", 1);
                            plat.setAttribute("fill", "none");
                            svg.appendChild(plat);
                        });
                    }

                    for (var i = -3; i <= 3; ++i)
                    {
                        if (i == 0)
                            continue;
                        var canv = document.createElement("div");
                        canv.id = o.stop_id + "p" +i;
                        canv.className = "section";
                        canv.style.top = i * 32 + (i < 0 ? 64 : 32) + "px";
                        canv.style.left = "64px";
                        sec.appendChild(canv);
                    }
                }
                if ('section_id' in o)
                {
                    sec.style.width = "64px";
                    svg.setAttribute("width", "64px");
                    svg.setAttribute("viewBox", "-32 -96 64 192");

                    o.section_id.forEach(function (s, i, a)
                    {
                        if (s == -1)
                            return;

                        var line = createSVG("line");
                        line.setAttribute("x1", -64);
                        line.setAttribute("y1", (i - a.length / 2) * -32 - 16);
                        line.setAttribute("x2", 64);
                        line.setAttribute("y2", (i - a.length / 2) * -32 - 16);
                        line.setAttribute("stroke", "black");
                        line.setAttribute("stroke-width", 2);
                        svg.appendChild(line);

                        var canv = document.createElement("div");
                        canv.id = s;
                        canv.className = "section";
                        canv.style.top = (i - a.length / 2) * -32 + 32 + "px";
                        canv.style.left = "0";
                        sec.appendChild(canv);
                    });
                }
                sec.insertBefore(svg, sec.firstChild);
                main.appendChild(sec);
            });

            update();
            setInterval(update, 30000);
        }


		function update()
		{            
            linedata[curline].sections.forEach(function (o, i, a){
            if ('stop_id' in o )
            {
                for (let i=-3; i<=3; ++i)
                {
                    var p = o.stop_id + "p" +i
                    var elem = document.getElementById(p);
                    if (elem != null)
                    {
                        while (elem.lastChild)
                            elem.removeChild(elem.lastChild);
                    }
                }
            }

            if ('section_id' in o)
            {
                for (let i=0; i<4; ++i){
                    var q = o.section_id[i];
                    var elem = document.getElementById(q);
                    if (elem != null)
                    {
                        while (elem.lastChild)
                                elem.removeChild(elem.lastChild);
                    }
                }
            }
            })
            var elem = document.getElementById("log");
            if (elem != null)
                elem.innerText = "";

            var line = 1
            var line_list = [linedata[curline].uri]

            if(linedata[curline].line_id == "Chuo"){
                line = 2
                line_list = ["odpt.Railway:JR-East.ChuoRapid","odpt.Railway:JR-East.Chuo"]
            }
            for (let x=0; x < line; x++){
                url = "https://api-challenge.odpt.org/api/v4/odpt:Train?odpt:operator=odpt.Operator:Tobu&acl:consumerKey=" + token + "&odpt:railway="+ line_list[x]
                fetch(url)
                .then(function (data) {
                    if (!data.ok) {
                    throw new Error(data.statusText);
                    }
                    return data.json(); // 読み込むデータをJSONに設定
                })
                .then(function (res) {

                    elem = document.getElementById("headtime");
                        if (elem != null)
                            elem.innerText = "";

                    var updatetime = document.createElement("div");
                    updatetime.className = "updatetime";
                    updatetime.innerHTML = "<div style=\"text-align: left;\">" + res[0]["dc:date"] +"</div>";
                    document.getElementById("headtime").appendChild(updatetime)

                        res.forEach(function (o, i, a)
                        {
                            var line_code = o["odpt:railway"].split('.')
                            var sy_id = "";
                            if("odpt:trainType" in o)
                                sy_id = sy_list[o["odpt:trainType"]][0];
                            var tra = document.createElement("div");
                            tra.className = "train linetb" + line_code[2] +" tbsy"+sy_id;
                            var box = document.createElement("div");
                            
                            var sr_add =""
                            if("odpt:carComposition" in o){
                                sr_add = sr_list[o["odpt:carComposition"]]
                            }

                            box.className = "box";
                            box.innerHTML = "<div style=\"text-align: left;\">" + o["odpt:trainNumber"] + sr_add +"</div>";
                            tra.appendChild(box);

                            var dir = document.createElement("div");
                            dir.className = (o["odpt:railDirection"] == "odpt.RailDirection:Inbound" ? "up" : "down");
                            tra.appendChild(dir);
                            if (o["odpt:delay"] != "0")
                            {
                                var delay = document.createElement("div");
                                delay.className = "delay";
                                delay.innerHTML = "+" + (o["odpt:delay"]/60);
                                tra.appendChild(delay);
                            }

                            var info = document.createElement("div");
                            info.className = "info";

                            if ("odpt:trainType" in o && o["odpt:trainType"] != "" && o["odpt:trainType"] in sy_list)
                            {
                                sy_add = sy_list[o["odpt:trainType"]][2]
                                info.innerHTML += sy_add
                            }

                            if ("odpt:destinationStation" in o && o["odpt:destinationStation"] != "" && o["odpt:destinationStation"] in sta_list)
                            {
                                ik_add = sta_list[o["odpt:destinationStation"]][1]
                                info.innerHTML += ik_add
                            }

                            if (info.innerHTML != "")
                            tra.appendChild(info);


                            var elem;
                            if ("odpt:fromStation" in o && "odpt:toStation" in o)
                            {
                                dir = (o["odpt:railDirection"] == "odpt.RailDirection:Inbound" ? "1" : "-1")
                                past = o["odpt:fromStation"].split('.')
                                numl = o["odpt:trainNumber"].slice(0,1)
                                
                                elem = past[3] + "p" + dir

                                if(o["odpt:toStation"] != null) //駅間指定
                                {
                                    next = o["odpt:toStation"].split('.')
                                    elem = past[3] + "_" + next[3]

                                    if(sy_list[o["odpt:trainType"]][0] == 1){
                                        if(next[3] == "Kosuge" ||next[3] == "Gotanno" || next[3] == "Umejima" || next[3] == "Nishiarai" || next[3] == "Takenotsuka" || next[3] == "Yatsuka" || next[3] == "Soka" || next[3] == "Dokkyodaigakumae" || next[3] == "Shinden" || next[3] == "Gamo" || next[3] == "ShinKoshigaya" || next[3] == "Koshigaya"){
                                            elem = "L_" + past[3] + "_" + next[3]
                                        }
                                        if(next[3] == "KitaKoshigaya" && o["odpt:railDirection"] == "odpt.RailDirection:Outbound"){
                                            elem = "L_" + past[3] + "_" + next[3]
                                        }
                                        if(next[3] == "KitaSenju" && o["odpt:railDirection"] == "odpt.RailDirection:Inbound"){
                                            elem = "L_" + past[3] + "_" + next[3]
                                        }
                                    }
                                }else{ //駅停車中
                                    if(line_code[2] == "TobuSkytree"){
                                        if(past[3] == "Hikifune" && numl != "C" && numl != "D" && numl != "E" && numl != "F"){
                                            dir = (o["odpt:railDirection"] == "odpt.RailDirection:Inbound" ? "2" : "-2")
                                            elem = past[3] + "p" + dir
                                        }
                                        if(past[3] == "Kanegafuchi"){
                                            if(sy_list[o["odpt:trainType"]][0] == 1 || sy_list[o["odpt:trainType"]][0] == 4 || sy_list[o["odpt:trainType"]][0] == 6){
                                                dir = (o["odpt:railDirection"] == "odpt.RailDirection:Inbound" ? "2" : "-2")
                                                elem = past[3] + "p" + dir
                                            }
                                        }
                                        if(past[3] == "KitaSenju"){
                                            dir = (o["odpt:railDirection"] == "odpt.RailDirection:Inbound" ? "3" : "-1") 
                                            if(numl == "A" || numl == "B"){
                                                dir = (o["odpt:railDirection"] == "odpt.RailDirection:Inbound" ? "-2" : "-3")   
                                            }
                                            if(o["odpt:destinationStation"][0] == "odpt.Station:Tobu.TobuSkytree.KitaSenju")
                                                dir = 1
                                            elem = past[3] + "p" + dir
                                        }
                                        if(past[3] == "Kosuge" || past[3] == "Gotanno" || past[3] == "Umejima" || past[3] == "Nishiarai" || past[3] == "Takenotsuka" || past[3] == "Yatsuka" || past[3] == "Dokkyodaigakumae" || past[3] == "Shinden" || past[3] == "Gamo" || past[3] == "ShinKoshigaya" || past[3] == "Koshigaya" || past[3] == "KitaKoshigaya"){
                                            dir = (o["odpt:railDirection"] == "odpt.RailDirection:Inbound" ? "2" : "-2")
                                            if(sy_list[o["odpt:trainType"]][0] == 1)
                                                dir = (o["odpt:railDirection"] == "odpt.RailDirection:Inbound" ? "1" : "-1")
                                            elem = past[3] + "p" + dir
                                        }
                                        if(past[3] == "Soka" || past[3] == "Koshigaya")
                                        {
                                            dir = (o["odpt:railDirection"] == "odpt.RailDirection:Inbound" ? "3" : "-3")
                                            if(sy_list[o["odpt:trainType"]][0] == 1)
                                                dir = (o["odpt:railDirection"] == "odpt.RailDirection:Inbound" ? "1" : "-1")
                                            if(sy_list[o["odpt:trainType"]][0] >= 3 && sy_list[o["odpt:trainType"]][0] <= 6)
                                            {dir = (o["odpt:railDirection"] == "odpt.RailDirection:Inbound" ? "2" : "-2")}                       
                                            elem = past[3] + "p" + dir            
                                        }
                                        if(past[3] == "Sengendai"){
                                            if(sy_list[o["odpt:trainType"]][0] == 1 || sy_list[o["odpt:trainType"]][0] == 6)
                                                {dir = (o["odpt:railDirection"] == "odpt.RailDirection:Inbound" ? "2" : "-2")}
                                            elem = past[3] + "p" + dir 
                                        }
                                    }
                                }
                            }
                            if (document.getElementById(elem) != null){
                                try{
                                    document.getElementById(elem).appendChild(tra)
                                }
                                catch{
                                    document.getElementById("log").innerText += "Unknown: " + elem + "\t" + JSON.stringify(o["odpt:trainNumber"]) + "\n";
                                }
                            }
                            else
                                document.getElementById("log").innerText += "Unknown: " + elem + "\t" + JSON.stringify(o["odpt:trainNumber"]) + "\n";
                        }
                    )
                })
                .catch((error) => {
                    console.error('エラーが発生しました:', error);  //エラーをキャッチし表示     
                });
                //setTimeout(() => {}, 200);
            };
        }
        function trans(line)
        {
            if (curline != line)
                location.search = line;
        }
        document.addEventListener("DOMContentLoaded", init, false);

        // トークン検証
    const as = localStorage.getItem('authToken');
    const tokenExpiry = localStorage.getItem('tokenExpiry');

    if (!as || !tokenExpiry || Date.now() > tokenExpiry) {
        // 無効な場合はログインページへ
        alert('セッションが切れました');
        window.location.href = 'index.html';
    }

        </script>
</head>
<body>
    <div id="sel" style="padding-bottom: 32px;">
	<button type="button" onclick="location.href='toppage.html'">戻る</button>
	</div>
    <div id="headtime"></div>
	<div id="main"></div>
	<div id="log" style="clear: left;"></div>
</body>
</html>
