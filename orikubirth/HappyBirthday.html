<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy Birthday ãŠã‚Šãï¼</title>
    <style>
        :root {
            --primary: #ff8fa3;
            --gold: #ffcf56;
            --text-color: #5d4037;
        }

        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%;
            overflow: hidden; background: #fff;
            font-family: 'Hiragino Sans', 'Meiryo', sans-serif;
        }

        /* æ˜ã‚‹ã„èƒŒæ™¯ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ */
        #bg {
            position: fixed; width: 100%; height: 100%;
            background: linear-gradient(135deg, #fff9f9 0%, #fff0f3 100%);
            z-index: -2;
        }

        /* è£…é£¾ç”¨ã®å…‰ã®ç²’ */
        .kira {
            position: absolute; background: white; border-radius: 50%;
            filter: blur(2px); animation: twinkle 3s infinite;
        }
        @keyframes twinkle { 0%, 100% { opacity: 0.3; } 50% { opacity: 0.8; } }

        /* ã‚¹ãƒ†ãƒ¼ã‚¸ç®¡ç† */
        .stage {
            position: absolute; width: 100%; height: 100%;
            display: flex; justify-content: center; align-items: center;
            flex-direction: column; text-align: center; padding: 20px;
            box-sizing: border-box; transition: 0.5s;
        }
        .hidden { opacity: 0; pointer-events: none; transform: scale(0.9); }

        /* ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚«ãƒ¼ãƒ‰ */
        .msg-box {
            background: rgba(255, 255, 255, 0.9);
            padding: 30px 20px; border-radius: 25px;
            box-shadow: 0 10px 40px rgba(255, 143, 163, 0.2);
            border: 3px solid var(--primary);
            width: 90%; max-width: 350px;
            color: var(--text-color); position: relative; z-index: 20;
        }

        /* æ€ã„å‡ºå†™çœŸã®ã‚¹ãƒ­ãƒƒãƒˆ */
        .photo-frame {
            position: absolute; width: 200px; height: 200px;
            border: 8px solid white; box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            object-fit: cover; opacity: 0; z-index: 15;
            transition: 1s ease-in-out; border-radius: 10px;
        }
        .photo-show { opacity: 1; transform: scale(1.1) rotate(5deg); }

        /* ã‚¯ãƒ©ãƒƒã‚«ãƒ¼ã®ç ´ç‰‡ */
        .piece { position: absolute; pointer-events: none; z-index: 100; animation: fall 1.5s ease-out forwards; }
        @keyframes fall {
            0% { transform: translate(-50%, -50%) rotate(0); opacity: 1; }
            100% { transform: translate(var(--tx), var(--ty)) rotate(360deg); opacity: 0; }
        }

        /* ãƒœã‚¿ãƒ³ */
        .btn-main {
            background: var(--primary); color: white; border: none;
            padding: 18px 45px; border-radius: 50px; font-size: 1.2rem;
            font-weight: bold; cursor: pointer; box-shadow: 0 8px 20px rgba(255,143,163,0.4);
            animation: bounce 2s infinite;
        }
        @keyframes bounce { 0%, 20%, 50%, 80%, 100% {transform: translateY(0);} 40% {transform: translateY(-10px);} }

        h1 { color: var(--primary); margin-bottom: 10px; font-size: 1.8rem; }
    </style>
</head>
<body onclick="createCracker(event)">

      
    <div id="bg"></div>
    <audio id="bgm" src="present.mp3" loop></audio>

    <img src="photo1.jpg" id="p1" class="photo-frame" style="top:10%; left:5%;">
    <img src="photo2.jpg" id="p2" class="photo-frame" style="bottom:15%; right:5%;">
    <img src="photo3.jpg" id="p3" class="photo-frame" style="top:5%; right:10%;">

    <div id="stage1" class="stage">
        <div style="font-size: 5rem; margin-bottom: 20px;">ğŸ‚</div>
        <h1 style="color: var(--text-color);">Happy Birthday<br>ORIKU!</h1>
        <button class="btn-main" onclick="startApp()">ãƒ—ãƒ¬ã‚¼ãƒ³ãƒˆã‚’é–‹ã‘ã‚‹</button>
    </div>

    <div id="stage2" class="stage hidden">
        <div class="msg-box" onclick="handleTap(event)">
            <div id="text-area" style="font-size: 1.2rem; font-weight: bold; line-height: 1.8;"></div>
            <div style="font-size: 0.8rem; color: #aaa; margin-top: 20px;">ã‚¿ãƒƒãƒ—ã§æ¬¡ã¸</div>
        </div>
    </div>

    <div id="stage3" class="stage hidden">
        <div class="msg-box">
            <h1>LUCKY PHOTO âœ¨</h1>
            <div id="slot-res" style="font-size: 1.5rem; margin: 20px 0; color: #ff5252; font-weight: bold;">????</div>
            <button id="slot-btn" class="btn-main" style="padding: 10px 30px; background: var(--gold);" onclick="drawSlot(event)">å ã†ï¼</button>
            <div id="final-msg" class="hidden" style="margin-top: 20px;">
                <p>ã‹ã‚ã‹ã¿ã‚ˆã‚Šæ„Ÿè¬ã‚’è¾¼ã‚ã¦ï¼<br>ç´ æ•µãªæ–°ç”Ÿæ´»ã‚’ï¼ğŸš€</p>
                <small>ç”»é¢ã‚’ã‚¿ãƒƒãƒ—ã—ã¦ãŠç¥ã„ã—ã¦ã­ï¼</small>
            </div>
        </div>
    </div>

    <script>
        const messages = [
            "ãŠã‚Šãèª•ç”Ÿæ—¥ãŠã‚ã§ã¨ã†ï¼ğŸ¥³",
            "ã„ã¤ã‚‚éŠã‚“ã§ãã‚Œã¦æœ¬å½“ã«ã‚ã‚ŠãŒã¨ã†ï¼",
            "ã¾ãŸç¾½ç”°ç©ºæ¸¯ã¨ã‹è¡Œã£ã¦ã„ã£ã±ã„å†™çœŸæ’®ã‚ã†ã­ï¼ğŸ“¸",
            "ç´ æ•µãªä¸€å¹´ã«ãªã‚Šã¾ã™ã‚ˆã†ã«ï¼ï¼",
            "æ–°ç”Ÿæ´»ã‚‚ãŒã‚“ã°ã‚Œãƒ¼ï¼ï¼",
            "ç„¡ç†ã—ãªã„ã‚ˆã†ã«ã—ã¦ã€œğŸŒ¿",
            "ã‹ã‚ã‹ã¿"
        ];
        let step = 0;

        function startApp() {
            document.getElementById('bgm').play(); // éŸ³å£°ã‚’å†ç”Ÿ
            nextStage(1);
        }

        function nextStage(num) {
            document.getElementById(`stage${num}`).classList.add('hidden');
            setTimeout(() => {
                document.getElementById(`stage${num}`).style.display = 'none';
                const next = document.getElementById(`stage${num+1}`);
                next.style.display = 'flex';
                setTimeout(() => next.classList.remove('hidden'), 50);
                if(num === 1) showMsg();
            }, 600);
        }

        function showMsg() {
            document.getElementById('text-area').innerText = messages[step];
            // å†™çœŸã®è¡¨ç¤ºã‚¿ã‚¤ãƒŸãƒ³ã‚°
            if(step === 2) document.getElementById('p1').classList.add('photo-show');
            if(step === 4) document.getElementById('p2').classList.add('photo-show');
            if(step === 6) document.getElementById('p3').classList.add('photo-show');
        }

        function handleTap(e) {
            createCracker(e);
            step++;
            if(step < messages.length) {
                showMsg();
            } else {
                nextStage(2);
            }
        }

        function drawSlot(e) {
            createCracker(e);
            const spots = ["ã„ã£ã±ã„å†™çœŸã¨ã‚ã†ï¼", "ãƒ•ã‚©ãƒˆã‚°ãƒ©ãƒ•ã‚¡ï½±ï½±ï½±ãƒ¼", "å¤•æš®ã‚Œã®ç¬¬3ã‚¿ãƒ¼ãƒŸãƒŠãƒ« ğŸŒ‡", "é™ç•Œå…‰ç·šè²¨ç‰©åˆ—è»Š", "é›¢é™¸ç›´å¾Œã®æ©Ÿä½“ âœˆï¸", "ç©ºæ¸¯ã®å¤œæ™¯ âœ¨", "è‡¨æ™‚åˆ—è»Šé‹è»¢é€šé”ï¼", "ã‚¢ã‚²ãƒè¶", "æ¨ªæµœã®å¤œæ™¯ï¼"];
            const btn = document.getElementById('slot-btn');
            const res = document.getElementById('slot-res');
            btn.style.display = 'none';
            
            let count = 0;
            const timer = setInterval(() => {
                res.innerText = spots[Math.floor(Math.random() * spots.length)];
                count++;
                if(count > 12) {
                    clearInterval(timer);
                    res.style.fontSize = "1.8rem";
                    document.getElementById('final-msg').classList.remove('hidden');
                }
            }, 80);
        }

        function createCracker(e) {
            const colors = ['#FF8FA3', '#FFCF56', '#87CEEB', '#FFB74D', '#BA68C8'];
            for(let i=0; i<30; i++) {
                const p = document.createElement('div');
                p.className = 'piece';
                p.style.left = e.clientX + 'px';
                p.style.top = e.clientY + 'px';
                p.style.background = colors[Math.floor(Math.random()*colors.length)];
                const tx = (Math.random()-0.5)*400 + 'px';
                const ty = (Math.random()-0.5)*400 + 'px';
                p.style.setProperty('--tx', tx);
                p.style.setProperty('--ty', ty);
                p.style.width = Math.random()*10+5+'px';
                p.style.height = '6px';
                document.body.appendChild(p);
                setTimeout(() => p.remove(), 1500);
            }
        }

        // èƒŒæ™¯ã«å…‰ã®ç²’ã‚’ç”Ÿæˆ
        for(let i=0; i<20; i++) {
            const k = document.createElement('div');
            k.className = 'kira';
            k.style.width = k.style.height = Math.random()*15+5+'px';
            k.style.left = Math.random()*100+'vw';
            k.style.top = Math.random()*100+'vh';
            k.style.animationDelay = Math.random()*3+'s';
            document.body.appendChild(k);
        }
    </script>
</body>
</html>
